<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta content="text/html; charset=UTF-8" http-equiv="Content-Type"/><title>Integrate encryption into Google Calendar with Firefox extensions</title><meta http-equiv="PICS-Label" content='(PICS-1.1 "http://www.icra.org/ratingsv02.html" l gen true r (cz 1 lz 1 nz 1 oz 1 vz 1) "http://www.rsac.org/ratingsv01.html" l gen true r (n 0 s 0 v 0 l 0) "http://www.classify.org/safesurf/" l gen true r (SS~~000 1))' />
<link rel="schema.DC" href="http://purl.org/DC/elements/1.0/" />
<link rel="SHORTCUT ICON" href="http://www.ibm.com/favicon.ico" />
<meta name="Owner" content="dW Information/Raleigh/IBM" />
<meta name="DC.Language" scheme="rfc1766" content="en" />
<meta name="IBM.Country" content="ZZ" />
<meta name="Security" content="Public" />
<meta name="IBM.SpecialPurpose" content="SP001" />
<meta name="IBM.PageAttributes" content="sid=1003"/>
<meta name="Source" content="Based on v15 Template Generator, Template 15"/><meta name="Abstract" content="Today's Web applications provide many benefits for online storage, access, and collaboration. Although some applications offer encryption of user data, most do not. This article provides tools and code needed to add basic encryption support for user data in one of the most popular online calendar applications. Building on the incredible flexibility of Firefox extensions and the Gnu Privacy Guard, this article shows you how to store only encrypted event descriptions in Google's Calendar application, while displaying a plain text version to anyone with the appropriate decryption keys." /><meta name="Description" content="Today's Web applications provide many benefits for online storage, access, and collaboration. Although some applications offer encryption of user data, most do not. This article provides tools and code needed to add basic encryption support for user data in one of the most popular online calendar applications. Building on the incredible flexibility of Firefox extensions and the Gnu Privacy Guard, this article shows you how to store only encrypted event descriptions in Google's Calendar application, while displaying a plain text version to anyone with the appropriate decryption keys." /><meta name="Keywords" content="Google Calendar, Encryption, Firefox, Linux, tttwaca, tttlca, tttosca" /><meta name="DC.Date" scheme="iso8601" content="2008-07-15" /><meta name="DC.Type" scheme="IBM_ContentClassTaxonomy" content="CT316" /><meta name="DC.Subject" scheme="IBM_SubjectTaxonomy" content="TTA00" /><meta name="DC.Rights" content="Copyright (c) 2008 by IBM Corporation" /> <meta name="Robots" content="index,follow" /><meta name="IBM.Effective" scheme="W3CDTF" content="2008-07-15" /><meta name="Last update" content="15072008shardson@us.ibm.com" /><!-- STYLESHEETS/SCRIPTS -->
<!-- for tables -->
<link rel="stylesheet" type="text/css" media="screen,print" href="//www.ibm.com/common/v15/table.css" /> 
<!-- end for tables -->
<script language="JavaScript" src="/developerworks/js/dwcss14.js" type="text/javascript"></script>
<link rel="stylesheet" type="text/css" href="//www.ibm.com/common/v15/main.css" />
<link rel="stylesheet" type="text/css" media="all" href="//www.ibm.com/common/v15/screen.css" />
<link rel="stylesheet" type="text/css" media="print" href="//www.ibm.com/common/v15/print.css" />
<script language="JavaScript" src="//www.ibm.com/common/v15/detection.js" type="text/javascript"></script>
<script language="JavaScript" src="//www.ibm.com/common/js/ibmcommon.js" type="text/javascript">//</script>
<script language="JavaScript" src="//www.ibm.com/common/js/dynamicnav.js" type="text/javascript">//</script>
<script language="JavaScript" src="/developerworks/js/dropdown.js" type="text/javascript"></script>
<script language="JavaScript" src="/developerworks/email/grabtitle.js" type="text/javascript"></script>
<script language="JavaScript" src="/developerworks/email/emailfriend2.js" type="text/javascript"></script><script language="JavaScript" src="/developerworks/js/urltactic.js" type="text/javascript"></script><script language="JavaScript" type="text/javascript">
 <!--
 setDefaultQuery('webart');
 //-->
</script>
<!--START RESERVED FOR FUTURE USE INCLUDE FILES--><script language="javascript" src="/developerworks/js/ajax1.js" type="text/javascript"></script><script language="javascript" src="/developerworks/js/search_counter.js" type="text/javascript"></script><script language="javascript" src="/developerworks/js/request_referer_capture.js" type="text/javascript"></script><script language="javascript" src="/developerworks/js/summaries_switcher.js" type="text/javascript"></script><!--END RESERVED FOR FUTURE USE INCLUDE FILES--><script language="JavaScript" type="text/javascript">var emailAbstract = "Today's Web applications provide many benefits for online storage, access, and collaboration. Although some applications offer encryption of user data, most do not. This article provides tools and code needed to add basic encryption support for user data in one of the most popular online calendar applications. Building on the incredible flexibility of Firefox extensions and the Gnu Privacy Guard, this article shows you how to store only encrypted event descriptions in Google's Calendar application, while displaying a plain text version to anyone with the appropriate decryption keys."; </script></head><BR><BR>This is an archived cached-text copy of the developerWorks article.  Please consider viewing the original article at: <a href="http://www-128.ibm.com/developerworks/library/wa-googlecal">IBM developerWorks</a><BR><BR><BR><BR><body><!--MASTHEAD_BEGIN--><div id="ibm-top" class="ibm-liquid">
<div class="ibm-access"><a href="#main">Skip to main content</a></div>

<div id="ibm-masthead">
<div id="ibm-logo"><a href="http://www.ibm.com/"><img width="110" src="//www.ibm.com/i/v16/t/ibm-logo.gif" height="50" alt="IBM&reg;"/></a></div>

<ul id="ibm-geo">
<li class="ibm-first" id="ibm-country">Country/region</li>
<li id="ibm-change-country">[ <a href="http://www.ibm.com/developerworks/country/">select</a> ]</li>
</ul>

<form id="ibm-search-form" action="//www.ibm.com/developerworks/search/searchResults.jsp" method="get" name="form1"><input type="hidden" name="searchType" value="1"/><input type="hidden" name="searchSite" value="dW"/><p>
<span id="ibm-search-scope">
<label for="sn"><img src="//www.ibm.com/i/c.gif" width="1" height="1" alt="Search in:"/></label>
<select class="input-local" name="searchScope" id="sn" size="1">
<option value="dW" selected="selected">All of dW</option>
<option value="dW">-----------------</option>
<option value="aixunix">&nbsp;&nbsp;AIX and UNIX</option>
<option value="db2">&nbsp;&nbsp;Information Mgmt</option>
<option value="lotus">&nbsp;&nbsp;Lotus</option>
<option value="rdd">&nbsp;&nbsp;Rational</option>
<option value="tivoli">&nbsp;&nbsp;Tivoli</option>  
<option value="WSDD">&nbsp;&nbsp;WebSphere</option>
<option value="dW">-----------------</option> 
<option value="archZ">&nbsp;&nbsp;Architecture</option>
<option value="acZ">&nbsp;&nbsp;Autonomic computing</option>
<option value="javaZ">&nbsp;&nbsp;Java technology</option> 
<option value="linuxZ">&nbsp;&nbsp;Linux</option> 
<option value="paZ">&nbsp;&nbsp;Multicore acceleration</option>
<option value="opensrcZ">&nbsp;&nbsp;Open source</option>
<option value="webservZ">&nbsp;&nbsp;SOA &amp; Web services</option>
<option value="webarchZ">&nbsp;&nbsp;Web development</option>  
<option value="xmlZ">&nbsp;&nbsp;XML</option>
<option value="dW">-----------------</option>
<option value="forums">&nbsp;&nbsp;dW forums</option> 
<option value="dW">-----------------</option>
<option value="aW">alphaWorks</option>
<option value="dW">-----------------</option>
<option value="all">All of IBM</option>
</select>
</span>

<label for="q"><img alt="Search for:" height="1" width="1" src="//www.ibm.com/i/c.gif" /></label><input type="text" name="query" maxlength="100" id="q"/><input type="submit" id="ibm-search" class="ibm-btn-search" name="Search" value="Search" /></p></form>

<div id="ibm-site-name">
<!-- IBM site name container -->
</div>

<div id="ibm-universal-nav">
<ul>
<li class="ibm-first" id="ibm-unav-home"><a href="http://www.ibm.com/">Home</a></li>
<li id="ibm-unav-solutions"><a href="http://www.ibm.com/businesssolutions/">Business solutions</a></li>
<li id="ibm-unav-services"><a href="http://www.ibm.com/technologyservices/">IT services</a></li>
<li id="ibm-unav-products"><a href="http://www.ibm.com/products/">Products</a></li>
<li id="ibm-unav-support"><a href="http://www.ibm.com/support/">Support &amp; downloads</a></li>
<li id="ibm-unav-myibm"><a href="http://www.ibm.com/account/">My IBM</a></li>
</ul>
</div>

</div>

<script type="text/javascript" language="JavaScript" src="//www.ibm.com/common/v15/pmh.js">
</script>

<!--MASTHEAD_END--><!-- CMA ID: 320748 --> <!-- Site ID: 1 --><table id="v14-body-table" border="0" cellpadding="0" cellspacing="0" width="100%"><tr valign="top"><!--LEFTNAV_BEGIN--><td id="navigation" width="150"><table width="150" cellspacing="0" cellpadding="0" border="0"><tr><td class="left-nav-spacer"><a href="http://www.ibm.com/developerworks" class="left-nav-overview"> </a></td></tr></table><table width="150" cellspacing="0" cellpadding="0" border="0"><tr><td colspan="2" class="left-nav-overview"><a href="http://www.ibm.com/developerworks" class="left-nav-overview">developerWorks</a></td></tr></table><table width="150" cellspacing="0" cellpadding="0" border="0"><tr><td colspan="2" class="left-nav-highlight"><a href="#" class="left-nav">In this article:</a></td></tr><tr class="left-nav-child-highlight"><td><img alt="" height="8" width="2" src="//www.ibm.com/i/v14/t/cl-bullet.gif"/></td><td><a href="#N10085" class="left-nav-child">Requirements</a></td></tr><tr class="left-nav-child-highlight"><td><img alt="" height="8" width="2" src="//www.ibm.com/i/v14/t/cl-bullet.gif"/></td><td><a href="#N100A5" class="left-nav-child">General program approach</a></td></tr><tr class="left-nav-child-highlight"><td><img alt="" height="8" width="2" src="//www.ibm.com/i/v14/t/cl-bullet.gif"/></td><td><a href="#N100D0" class="left-nav-child">Building on the Google Calendar Quick Add
        extension</a></td></tr><tr class="left-nav-child-highlight"><td><img alt="" height="8" width="2" src="//www.ibm.com/i/v14/t/cl-bullet.gif"/></td><td><a href="#N10146" class="left-nav-child">Modifying the Quick Add extension to support transparent encryption</a></td></tr><tr class="left-nav-child-highlight"><td><img alt="" height="8" width="2" src="//www.ibm.com/i/v14/t/cl-bullet.gif"/></td><td><a href="#N10298" class="left-nav-child">Usage examples</a></td></tr><tr class="left-nav-child-highlight"><td><img alt="" height="8" width="2" src="//www.ibm.com/i/v14/t/cl-bullet.gif"/></td><td><a href="#N102B1" class="left-nav-child">Conclusion, further examples</a></td></tr><tr class="left-nav-child-highlight"><td><img alt="" height="8" width="2" src="//www.ibm.com/i/v14/t/cl-bullet.gif"/></td><td><a href="#download" class="left-nav-child">Download</a></td></tr><tr class="left-nav-child-highlight"><td><img alt="" height="8" width="2" src="//www.ibm.com/i/v14/t/cl-bullet.gif"/></td><td><a href="#resources" class="left-nav-child">Resources</a></td></tr><tr class="left-nav-child-highlight"><td><img alt="" height="8" width="2" src="//www.ibm.com/i/v14/t/cl-bullet.gif"/></td><td><a href="#author" class="left-nav-child">About the author</a></td></tr><tr class="left-nav-child-highlight"><td><img alt="" height="8" width="2" src="//www.ibm.com/i/v14/t/cl-bullet.gif"/></td><td><a href="#rate" class="left-nav-child">Rate this page</a></td></tr><tr class="left-nav-last"><td width="14"><img class="display-img" alt="" height="1" width="14" src="//www.ibm.com/i/c.gif"/></td><td width="136"><img class="display-img" alt="" height="19" width="136" src="//www.ibm.com/i/v14/t/left-nav-corner.gif"/></td></tr></table><br /><table width="150" cellspacing="0" cellpadding="0" border="0"><tr><td class="related" colspan="2"><b class="related">Related links</b></td></tr><tr class="rlinks"><td><img alt="" height="8" width="2" src="//www.ibm.com/i/v14/t/rl-bullet.gif"/></td><td><a class="rlinks" href="http://www.ibm.com/developerworks/views/web/library.jsp">Web development technical library</a></td></tr><tr class="rlinks"><td><img alt="" height="8" width="2" src="//www.ibm.com/i/v14/t/rl-bullet.gif"/></td><td><a class="rlinks" href="http://www.ibm.com/developerworks/views/linux/library.jsp">Linux technical library</a></td></tr><tr class="rlinks"><td><img alt="" height="8" width="2" src="//www.ibm.com/i/v14/t/rl-bullet.gif"/></td><td><a class="rlinks" href="http://www.ibm.com/developerworks/views/opensource/library.jsp">Open source technical library</a></td></tr><!--START RESERVED FOR FUTURE USE INCLUDE FILES--><!-- No content currently --><!--END RESERVED FOR FUTURE USE INCLUDE FILES--><tr><td width="14"><img class="display-img" alt="" height="1" width="14" src="//www.ibm.com/i/c.gif"/></td><td width="136"><img class="display-img" alt="" height="19" width="136" src="//www.ibm.com/i/c.gif"/></td></tr></table><!--START RESERVED FOR FUTURE USE INCLUDE FILES--><!-- Next Steps Area:  Start -->
<!-- Commented out the include call in the dwmaster version of this file to prevent ajax calls
     being made during article previews and testing.  Live site has uncommented copy of this file (jpp) -->
<!-- Call Next Steps Servlet -->
<script language="JavaScript" type="text/javascript">
<!--
/*
 * ajaxInclude makes a call to the url and render the results in the div tag specified in divId
 */
function ajaxInclude(url, divId) { 
 var req = newXMLHttpRequest(); 
 if (req) { 
   req.onreadystatechange = getReadyStateHandler(req, 
	function (result) {  
           var contents = document.getElementById(divId);  
           if (result != null && result.length > 0 && contents != null) {
	     contents.innerHTML = result;  
           }
        }); 
   req.open("GET", url, true);
   req.send("");
 }
}
//-->
</script>

<!-- Display Next Steps Result -->
<div id="nextsteps"></div>

<!-- Initiate Next Steps Call -->
<script language="JavaScript" type="text/javascript">
<!-- 
 ajaxInclude("/developerworks/niagara/jsp/getNiagaraContent.jsp?url="+window.location.href,"nextsteps");
//-->
</script>
<!-- Next Steps Area:  End --><!--END RESERVED FOR FUTURE USE INCLUDE FILES--></td><!--LEFTNAV_END--><td width="100%"><table id="content-table" border="0" cellpadding="0" cellspacing="0" width="100%"><tr valign="top"><td width="100%"><table border="0" cellpadding="0" cellspacing="0" width="100%"><tr><td><a name="main"><img border="0" alt="skip to main content" height="1" width="592" src="//www.ibm.com/i/c.gif"/></a></td></tr></table><table border="0" cellpadding="0" cellspacing="0" width="100%"><tr valign="top"><td height="18" width="10"><img alt="" height="18" width="10" src="//www.ibm.com/i/c.gif"/></td><td width="100%"><img alt="" height="6" width="1" src="//www.ibm.com/i/c.gif"/><br /><a href="http://www.ibm.com/developerworks/" class="bctl">developerWorks</a><span class="bct">  &gt;  </span><a class="bctl" href="http://www.ibm.com/developerworks/web/">Web development</a><span class="bct"> | </span><a href="http://www.ibm.com/developerworks/linux/" class="bctl">Linux</a><span class="bct"> | </span><a href="http://www.ibm.com/developerworks/opensource/" class="bctl">Open source</a><span class="bct">  &gt;</span><img alt="" height="1" width="1" src="//www.ibm.com/i/c.gif"/><br /><h1>Integrate encryption into Google Calendar with Firefox extensions</h1><p id="subtitle"><em>Store
    only encrypted data for event names and descriptions in Google Calendar</em></p><img alt="" height="6" width="1" src="//www.ibm.com/i/c.gif" class="display-img"/></td><td class="no-print" width="192"><a href="http://www.ibm.com/developerworks/"><img alt="developerWorks" border="0" height="18" width="192" src="/developerworks/i/dw.gif"/></a></td></tr></table></td></tr></table><table border="0" cellpadding="0" cellspacing="0" width="100%"><tr valign="top"><td width="10"><img alt="" height="1" width="10" src="//www.ibm.com/i/c.gif"/></td><td width="100%"><table class="no-print" border="0" width="160" cellspacing="0" cellpadding="0" align="right"><tr><td width="10"><img alt="" height="1" width="10" src="//www.ibm.com/i/c.gif"/></td><td><table width="150" cellspacing="0" cellpadding="0" border="0"><tr><td class="v14-header-1-small">Document options</td></tr></table><table class="v14-gray-table-border" cellspacing="0" cellpadding="0" border="0"><tr><td class="no-padding" width="150"><table width="143" cellspacing="0" cellpadding="0" border="0"><script language="JavaScript" type="text/javascript">
<!--
document.write('<tr valign="top"><td width="8"><img src="//www.ibm.com/i/c.gif" width="8" height="1" alt=""/></td><td width="16"><img alt="Set printer orientation to landscape mode" height="16" src="//www.ibm.com/i/v14/icons/printer.gif" width="16" vspace="3" /></td><td width="122"><p><b><a class="smallplainlink" href="javascript:print()">Print this page</a></b></p></td></tr>');
//-->
</script>
<noscript></noscript><tr valign="top"><td width="8"><img alt="" height="1" width="8" src="//www.ibm.com/i/c.gif"/></td><td width="16"><img vspace="5" width="16" src="//www.ibm.com/i/v14/icons/pdf.gif" height="16" alt="PDF format - Fits A4 and Letter"/></td><td width="122"><p><a href="http://download.boulder.ibm.com/ibmdl/pub/software/dw/web/wa-googlecal/wa-googlecal-pdf.pdf" onkeypress="sa_onclick(this.href)" onclick="sa_onclick(this.href)" class="smallplainlink"><b>PDF - Fits A4 and Letter</b></a><br /><span class="small">169KB (14 pages)</span></p></td></tr><tr valign="top"><td width="8"><img alt="" height="1" width="8" src="//www.ibm.com/i/c.gif"/></td><td width="16"><img vspace="5" alt="" height="16" width="16" src="//www.ibm.com/i/v14/icons/sout.gif"/></td><td width="122"><p><a href="http://www.adobe.com/products/acrobat/readstep2.html" class="smallplainlink"><b>Get Adobe&#174; Reader&#174;</b></a></p></td></tr><script language="JavaScript" type="text/javascript">
<!-- 5.6 10/24 llk: added cdata around the subdirectory path of email gif-->
<!--
document.write('<tr valign="top"><td width="8"><img src="//www.ibm.com/i/c.gif" width="8" height="1" alt=""/></td><td width="16"><img src="//www.ibm.com/i/v14/icons/em.gif" height="16" width="16" vspace="3" alt="Email this page" /></td><td width="122"><p><a class="smallplainlink" href="javascript:void newWindow()"><b>E-mail this page</b></a></p></td></tr>');
//-->
</script><noscript><tr valign="top"><td width="8"><img alt="" height="1" width="8" src="//www.ibm.com/i/c.gif"/></td><td width="16"><img alt="" width="16" height="16" src="//www.ibm.com/i/c.gif"/></td><td class="small" width="122"><p><span class="ast">Document options requiring JavaScript are not displayed</span></p></td></tr></noscript><tr valign="top"><td width="8"><img alt="" height="1" width="8" src="//www.ibm.com/i/c.gif"/></td><td width="16"><img alt="" vspace="3" border="0" width="16" height="16" src="//www.ibm.com/i/v14/icons/dn.gif"/></td><td width="122"><p><a href="#download" class="smallplainlink"><b>Sample code</b></a></p></td></tr></table></td></tr></table><!--START RESERVED FOR FUTURE USE INCLUDE FILES--><!-- 11/28/07 refreshed by gem, per MOC --> 

<!--<br /><table border="0" cellpadding="0" cellspacing="0" width="150"><tr><td class="v14-header-2-small">New forum features</td></tr></table><table border="0" cellpadding="0" cellspacing="0" class="v14-gray-table-border"><tr><td width="150" class="no-padding"><table border="0" cellpadding="0" cellspacing="0" width="143"><tr valign="top"><td width="8"><img src="//www.ibm.com/i/c.gif" width="8" height="1" alt=""/></td><td><img src="//www.ibm.com/i/v14/icons/fw_bold.gif" height="16" width="16" border="0" vspace="3" alt=""/></td><td width="125"><p><a href="http://www.ibm.com/developerworks/community/forum/?S_TACT=105AGX01&amp;S_CMP=LEAF" class="smallplainlink">Try private messaging, 
read-tracking, and more
</a>
</p></td></tr></table></td></tr></table>--><!--END RESERVED FOR FUTURE USE INCLUDE FILES--><br /><table width="150" cellspacing="0" cellpadding="0" border="0"><tr><td class="v14-header-2-small">Rate this page</td></tr></table><table class="v14-gray-table-border" cellspacing="0" cellpadding="0" border="0"><tr><td class="no-padding" width="150"><table width="143" cellspacing="0" cellpadding="0" border="0"><tr valign="top"><td width="8"><img alt="" height="1" width="8" src="//www.ibm.com/i/c.gif"/></td><td><img alt="" vspace="3" border="0" width="16" height="16" src="//www.ibm.com/i/v14/icons/d_bold.gif"/></td><td width="125"><p><a href="#rate" class="smallplainlink"><b>Help us improve this content</b></a></p></td></tr></table></td></tr></table><br /></td></tr></table><p>Level: Introductory</p><p><a href="#author">Nathan Harrington</a> (<a href="mailto:harrington.nathan@gmail.com?subject=Integrate encryption into Google Calendar with Firefox extensions">harrington.nathan@gmail.com</a>), I/T Specialist, IBM　<br /></p><p> 15 Jul  2008</p><blockquote>Today's Web applications provide many
        benefits for online storage, access, and collaboration. Although some applications offer
        encryption of user data, most do not. This article provides tools and code needed to add
        basic encryption support for user data in one of the most popular online calendar
        applications. Building on the incredible flexibility of Firefox extensions and the Gnu
        Privacy Guard, this article shows you how to store only encrypted event descriptions in
        Google's Calendar application, while displaying a plain text version to anyone with the
        appropriate decryption keys.</blockquote><!--START RESERVED FOR FUTURE USE INCLUDE FILES--><script type="text/javascript" language="javascript">
	     capture_referrer();
</script>

<!--  START : HTML FOR SEARCH REFERRER -->
  <div id="search_referrer_results" style="display:none">

  <!-- START KRUGLE SEARCH HEADING PLAY
					<table width="580" cellspacing="0" cellpadding="0" border="0">
                    <tr>
                      <td class="v14-header-5">
                     <strong>Show more developerWorks content related to my search</strong>
                      </td>
                    </tr>
                  </table> -->

<!--  START : HTML FOR ARTICLE SEARCH -->
  <div id="article_results" style="display:block"></div>
<!--  END : HTML FOR ARTICLE SEARCH -->

<!--  START : HTML FOR CODE SEARCH -->
   <div id="code_results" style="display:block"></div>
<!--  END : HTML FOR CODE SEARCH -->


   <br />
   <br />
   </div>
<!--  END : HTML FOR SEARCH REFERRER --><!--END RESERVED FOR FUTURE USE INCLUDE FILES-->

            <p>Beginning with Elias Torres' excellent "Google Calendar
        Quick Add" extension, this article walks you through the extraction, changes, and insertion
        of various components to enable encrypted events, not just forcing an encrypted TLS data
        channel. After following the instructions in this article, <a href="#fig1">Figure 1</a>,
        shown below, is an example of what the server operators will see on the left, and what the
        Web surfer will see on the right.</p>
            
                <br /><a name="fig1"><b>Figure 1. Google Calendar encrypted</b></a><br />
                <img alt="Google calendar encrypted" height="500" src="Figure1_overallDemo.jpg" width="572"/>
            <br />
            <p><a name="N10085"><span class="atitle">Requirements</span></a></p>
            <p><a name="N1008C"><span class="smalltitle">Hardware</span></a></p>
            <p>Any hardware capable of providing a
        post-2002 browsing experience should be sufficient for the code presented in this article.
        Encryption algorithms are highly processor-intensive, so if dozens or hundreds of calendar
        events need to be decrypted per page, you'll need fast hardware for a useful browsing
        experience.</p>
            <p><a name="N10095"><span class="smalltitle">Software</span></a></p>

            <p>Firefox 1.5
        or greater is required, as well as GnuPG - the Gnu Privacy Guard. Various Firefox extension
        development tools are also a good idea. Check the <a href="#resources">Resources</a> section below for links to these
        software packages.</p>
            <p>Although this article was developed on an Ubuntu 7.10 system, the
        concepts are easily transferable to a wide variety of operating environments.
        Make sure your
        system supports Perl, GnuPG, and Firefox before beginning development.</p>
            <br /><table border="0" cellspacing="0" cellpadding="0" width="100%"><tr><td><img width="100%" src="//www.ibm.com/i/v14/rules/blue_rule.gif" height="1" alt=""/></td></tr></table><table class="no-print" cellspacing="0" cellpadding="0" align="right"><tr align="right"><td><table border="0" cellpadding="0" cellspacing="0"><tr><td valign="middle"><img width="16" src="//www.ibm.com/i/v14/icons/u_bold.gif" height="16" border="0" alt=""/><br /></td><td valign="top" align="right"><a href="#main" class="fbox"><b>Back to top</b></a></td></tr></table></td></tr></table><br /><br /><p><a name="N100A5"><span class="atitle">General program approach</span></a></p>
            <p>This article assumes you have basic familiarity
        with the Firefox extension development process. No specific compiler or environment
        configuration is required, but you should be familiar with software development in
        order to diagnose problems or configuration issues specific to their setup.</p>

            <p>For
        development purposes, creating a new Firefox profile is recommended. Consult the
          <a href="#resources">Resources</a>
        section below for information on how to create a new profile, as well as links to helpful
        extension development sites.</p>
            <table align="right" border="0" cellspacing="0" cellpadding="0" width="40%"><tr><td width="10"><img alt="" height="1" width="10" src="//www.ibm.com/i/c.gif"/></td><td><table border="1" cellspacing="0" cellpadding="5" width="100%"><tr><td bgcolor="#eeeeee">
                <a name="N100B7"><b>Cross platform compatibility</b></a><br /> This article was
        developed on the Ubuntu 7.10 Linux&#174; distribution. If you're following this article verbatim,
        you'll need to be using a modern distribution of Linux. However, all of the software
        components referenced here (Firefox, GnuPG, and Perl) have Microsoft&#174;
        Windows&#174; versions. With some
        small modifications to the path names and external programs, the code presented here should
        work on a wide variety of platforms.</td></tr></table></td></tr></table>

            <p>GnuPG will be used to handle all of the encryption
        functions for this extension. This approach frees the JavaScript from less efficient
        algorithm implementation as well as providing robust cross-platform key management. You will
        need a fully functional GnuPG installation, with access to your encryption keys of choice.
        The <code>gpg-agent</code> program (usually part of the GnuPG package) is
        also required to handle the temporary storage and expiration of remembered
        passphrases.</p>
            <p>With a functional extension development environment and GnuPG to handle
        the encryption, modifying the interface will be done by changing some code in a previously
        developed extension. The Google Quick Add extension by Elias Torres provides a good starting
        point to insert the encryption modifications. In the encryption stage, the currently entered
        event text will be stored on disk, an external program will encrypt it, and then the encrypted
        file will be read in and sent to Google's servers. On decryption, each event is written to
        disk, unencrypted, and the plain text read back in to be displayed to the user.
        Alternatives to this approach involve writing new protocols for the Firefox program to
        manage. Although this process can provide a more robust data pipeline, the approach of
        output, processing, and reading is a relatively simple method of interprocess communication
        suitable for this class of extensions.</p>
            <p>Before continuing with the code presented in
        this article, make sure you have a functional Firefox GnuPG and gpg-agent set up.</p>
            <br /><table border="0" cellspacing="0" cellpadding="0" width="100%"><tr><td><img width="100%" src="//www.ibm.com/i/v14/rules/blue_rule.gif" height="1" alt=""/></td></tr></table><table class="no-print" cellspacing="0" cellpadding="0" align="right"><tr align="right"><td><table border="0" cellpadding="0" cellspacing="0"><tr><td valign="middle"><img width="16" src="//www.ibm.com/i/v14/icons/u_bold.gif" height="16" border="0" alt=""/><br /></td><td valign="top" align="right"><a href="#main" class="fbox"><b>Back to top</b></a></td></tr></table></td></tr></table><br /><br /><p><a name="N100D0"><span class="atitle">Building on the Google Calendar Quick Add
        extension</span></a></p>
            <p>The Google Calendar Quick Add extension makes use of the Google
        Calendar SOAP API to add events to your calendar from any page. Payload interception and
        encryption of this process is what this article uses to add encrypted events to your
        calendar. An alternate approach is to simply add ASCII-armored entries to your Google
        Calendar, but the approach here will automate this process for you.</p>

            <p>Begin by making a
        directory to hold the extension directories and code, such as <code>mkdir
          ~/calendarEncrypt</code>. Change to this directory and download the Quick Google Calendar
        Quick Add extension xpi from the link specified in the <a href="#resources">Resources</a> section
        below.</p>
            <p>Unpack the xpi extension with the command: <code>unzip
          quickgooglecal.xpi</code>. Change to the newly created chrome directory, and run the
        command <code>unzip quickgooglecal.jar</code>. You should now have a directory
        tree like the one shown in <a href="#listing1">Listing 1</a>
        below:</p>
            <br /><a name="listing1"><b>Listing 1. Google Calendar Quick Add directory structure</b></a><br /><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td class="code-outline"><pre class="displaycode">
                
calendarEncrypt/chrome.manifest
calendarEncrypt/readme.txt
calendarEncrypt/chrome
calendarEncrypt/chrome/content
calendarEncrypt/chrome/content/hello.xul
calendarEncrypt/chrome/content/overlay.xul
calendarEncrypt/chrome/content/overlay.js
calendarEncrypt/chrome/skin
calendarEncrypt/chrome/skin/overlay.css
calendarEncrypt/chrome/quickgooglecal.jar
calendarEncrypt/chrome/locale
calendarEncrypt/chrome/locale/en-US
calendarEncrypt/chrome/locale/en-US/hello.dtd
calendarEncrypt/chrome/locale/en-US/overlay.dtd
calendarEncrypt/install.rdf
calendarEncrypt/quickgooglecal.xpi
</pre></td></tr></table><br />

            <p>Change
        to the ~/calendarEncrypt directory and edit the install.rdf file. Make the changes to
        identifier and creator as shown in <a href="#listing2">Listing 2</a>
        below:</p>
            <br /><a name="listing2"><b>Listing 2. install.rdf identifier and creator changes </b></a><br /><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td class="code-outline"><pre class="displaycode">
                

Change the identifier:

  &lt;em:id&gt;{E31AE5B1-3E5B-4927-9B48-76C0A701F105}&lt;/em:id&gt;

to:

  &lt;em:id&gt;calendarEncrypt@devWorks_IBM.com&lt;/em:id&gt;

Also, change the creator:

    &lt;em:creator&gt;Elias Torres&lt;/em:creator&gt;

  to:

    &lt;em:creator&gt;Elias Torres with modifications from devWorks&lt;/em:creator&gt;
</pre></td></tr></table><br />

            <p>Edit
        the chrome.manifest file to change the jar-based extension packaging to a more
        developer-friendly directory structure packaging. <a href="#listing3">Listing 3</a> below shows the
        changes required.
        </p>
            <br /><a name="listing3"><b>Listing 3. chrome.manifest jar to directory structure changes </b></a><br /><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td class="code-outline"><pre class="displaycode">
                
                <span class="boldcode">Original chrome.manifest</span>

content quickgooglecal  jar:chrome/quickgooglecal.jar!/content/ 
overlay chrome://browser/content/browser.xul chrome://quickgooglecal/content/overlay.xul

locale  quickgooglecal  en-US   jar:chrome/quickgooglecal.jar!/locale/en-US/

skin    quickgooglecal  classic/1.0     jar:chrome/quickgooglecal.jar!/skin/
style   chrome://global/content/customizeToolbar.xul 
chrome://quickgooglecal/skin/overlay.css


<span class="boldcode">Change to directory based chrome.manifest:</span>

content quickgooglecal  chrome/content/

overlay chrome://browser/content/browser.xul chrome://quickgooglecal/content/overlay.xul

locale  quickgooglecal  en-US   chrome/locale/en-US/

skin    quickgooglecal  classic/1.0     chrome/skin/
style   chrome://global/content/customizeToolbar.xul 
chrome://quickgooglecal/skin/overlay.css
</pre></td></tr></table><br />

            <p>Now
        set a link to the current extension directory in your Firefox development profile. For
        example if your profile is <code>~/.mozilla/firefox/b2w2sglj.development</code>, create a link in <code>~/.mozilla/firefox/b2w2sglj.development/extensions/</code> called <code>calendarEncrypt@devWorks_IBM.com</code>. Place the current Google Quick Add development
        directory path in the <code>calendarEncrypt@devWorks_IBM.com</code> file,
        which for this example would be: <code>/home/username/calendarEncrypt</code>.</p>

            <p>Log in to Google Calendar and then press ctrl+;
        to activate the Google Calendar Quick Add extension. Verify that events can be added
        correctly by typing <code>Test unencrypted event tomorrow
15:30</code>. Verify
that the event appears on your calendar correctly.</p>
            <p>With the Google Calendar Quick Add
        extension in place, you can now being inserting the modifications to the extension that
        support encrypting and decrypting events.</p>
            <br /><table border="0" cellspacing="0" cellpadding="0" width="100%"><tr><td><img width="100%" src="//www.ibm.com/i/v14/rules/blue_rule.gif" height="1" alt=""/></td></tr></table><table class="no-print" cellspacing="0" cellpadding="0" align="right"><tr align="right"><td><table border="0" cellpadding="0" cellspacing="0"><tr><td valign="middle"><img width="16" src="//www.ibm.com/i/v14/icons/u_bold.gif" height="16" border="0" alt=""/><br /></td><td valign="top" align="right"><a href="#main" class="fbox"><b>Back to top</b></a></td></tr></table></td></tr></table><br /><br /><p><a name="N10146"><span class="atitle">Modifying the Quick Add extension to support transparent encryption</span></a></p>
            <p><a name="N1014C"><span class="smalltitle">Encrypting events as they are
        sent</span></a></p>

            <p>Interception and encryption of the Quick Add Event payloads are the
        processes used by this article to help automate the addition of encrypted events to your
        calendar. Modifying the existing extension to support the interception is shown starting
        below in <a href="#listing4">Listing 4</a>. Edit the <code>chrome/content/hello.xul</code> file and remove line 69: <code>var
          quickAddText = number_html(document.getElementById("quickText").value);</code>. Insert the
        following code at line
        69:</p>
            <br /><a name="listing4"><b>Listing 4. Encryption variables, date time extraction</b></a><br /><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td class="code-outline"><pre class="displaycode">
                
   var words = document.getElementById("quickText").value.split(' ');
   var dayVal = words[words.length-2];
   var timeVal = words[words.length-1];
   var elementData = "";
 
   for( var n=0; n &lt; words.length-2; n++ ){
     elementData = elementData + " " + words[n];
   }
</pre></td></tr></table><br />
            <p>The
        code presented above assumes that the date and time are always the last two words in the
        quick event text. To ensure accurate placement in the calendar, all future quick add events
        must be of the format "message text date time", where date is
        "friday/monday/tomorrow/etc",
        and time is "05:30/10:30/etc."</p>

            <p>With the event description text isolated from the event
        data and time, the next step is to write the event text to disk, and then encrypt it. Add the
        code shown below in <a href="#listing5">Listing 5</a> at line
        77:</p>
            <br /><a name="listing5"><b>Listing 5. Encryption write to disk, call program</b></a><br /><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td class="code-outline"><pre class="displaycode">
                
 
   // Write the quick event text to disk
   var fileOut = Components.classes["@mozilla.org/file/local;1"]
                       .createInstance(Components.interfaces.nsILocalFile);
   fileOut.initWithPath("/tmp/calendarEvent");
   var foStream = Components.classes["@mozilla.org/network/file-output-stream;1"]
                           .createInstance(Components.interfaces.nsIFileOutputStream);
   foStream.init(fileOut, 0x02 | 0x08 | 0x20, 0666, 0);
   foStream.write(elementData, elementData.length);
   foStream.close();


   // Run the external encryption process
   var fileExe = Components.classes["@mozilla.org/file/local;1"]
                       .createInstance(Components.interfaces.nsILocalFile);
   fileExe.initWithPath("/tmp/CalendarCrypt.pl");
   var process = Components.classes["@mozilla.org/process/util;1"]
                           .createInstance(Components.interfaces.nsIProcess);
   process.init(fileExe);
   var args = ["encrypt"];
   process.run(true, args, args.length);
</pre></td></tr></table><br />

            <p>The
        first section shown above in Listing 5 configures a file <code>"/tmp/calendarEvent"</code> for writing
        the intercepted event text to disk. This file contains plain text data, but will be shredded
        and removed after the encryption is complete. The second section in Listing 5 configures a
        file to execute using the recommended nsIProcess component. <code>/tmp/CalendarCrypt.pl</code> is a Perl
        program described in a later section that handles the encryption, decryption, and secure
        delete functions. After encrypting the data, the code in <a href="#listing6">Listing 6</a>,
        below, reads the encrypted event text back in. Place the following code at line 98 in <code>chrome/content/hello.xul</code>.</p>
            <br /><a name="listing6"><b>Listing 6. Encryption read file, build event text</b></a><br /><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td class="code-outline"><pre class="displaycode">
                
   // Read the encrypted text back in
   var fileIn = Components.classes["@mozilla.org/file/local;1"]
                       .createInstance(Components.interfaces.nsILocalFile);
   fileIn.initWithPath("/tmp/calendarEvent.asc");
   var istream = Components.classes["@mozilla.org/network/file-input-stream;1"]
                           .createInstance(Components.interfaces.nsIFileInputStream);
   istream.init(fileIn, 0x01, 0444, 0);
   istream.QueryInterface(Components.interfaces.nsILineInputStream);
 
   var data = "";
   var fstream = Components.classes["@mozilla.org/network/file-input-stream;1"]
                           .createInstance(Components.interfaces.nsIFileInputStream);
  var sstream = Components.classes["@mozilla.org/scriptableinputstream;1"]
                           .createInstance(Components.\
                           interfaces.nsIScriptableInputStream);
   // above line split on \ for formatting, do not include the line break

   fstream.init(fileIn, -1, 0, 0);
   sstream.init(fstream);
 
   var str = sstream.read(4096);
   while (str.length &gt; 0) {
     data += str;
     str = sstream.read(4096);
   }
 
   sstream.close();
   fstream.close();
   
   quickAddText = data + "  " + dayVal + " " + timeVal;
</pre></td></tr></table><br />
            <p>Code
        sections in Listing 5 demonstrated writing the text event to a file and running the
        encryption process. The code in Listing 6 shows reading the ASCII-armor encrypted text file
        in, appending the stored date and time information, and resuming the quick-add text process.
        </p>
            <p>Each event added using the Google Calendar Quick Add procedure will now be
        intercepted, encrypted, and posted to Google's servers in an encrypted form. </p>
            <p><a name="N101A2"><span class="smalltitle">Modifying overlay.js for encrypted event
        reading</span></a></p>
            <p>After completing the code for encrypting events in <code>chrome/content/hello.xul</code>, insert the code to decrypt the events in <code>chrome/content/overlay.js</code>. Insert the lines shown below in <a href="#listing7">Listing 7</a>, starting at the end of the
        file.</p>
            <br /><a name="listing7"><b>Listing 7. Decryption event listener, component definition</b></a><br /><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td class="code-outline"><pre class="displaycode">
                

window.addEventListener("load", function() { calendarDecryptExtension.init(); }, false);

var calendarDecryptExtension = {
  init: function() {
    var appcontent = document.getElementById("appcontent");   // browser
    if(appcontent)
      appcontent.addEventListener("DOMContentLoaded", this.onPageLoad, true);
    var messagepane = document.getElementById("messagepane"); // mail
   if(messagepane)
      messagepane.addEventListener("load", function () \
      { calendarDecryptExtension.onPageLoad(); }, false);
    // above line split on \ for formatting, do not include the line break
},

</pre></td></tr></table><br />

            <p>Every
        time the event display page is loaded, a call to the <code>calendarDecryptExtension</code> function is made using the <code>addEventListener</code>. Beginning the <code>calendarDecryptionExtension</code> function are the various definitions and hooks required
        to ensure the code is started on each page load, and that the appropriate data is accessible
        to the function. Place the code shown in <a href="#listing8">Listing 8</a>, below,
        underneath the Listing 7 lines to continue the document decryption
        processing:</p>
            <br /><a name="listing8"><b>Listing 8. onPageLoad function, writing events</b></a><br /><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td class="code-outline"><pre class="displaycode">
                
  onPageLoad: function(aEvent) {
    dump("pre elemenet \n");

    var elementData = "NODATA";
    var allSpans = content.document.getElementsByTagName("span");

    for (var n = 0; n &lt; allSpans.length; n++){
      if( allSpans[n].innerHTML.indexOf("BEGIN PGP") &gt; -1 ){

        // file output for encrypted event text
        elementData = allSpans[n].innerHTML;
        var fileOut = Components.classes["@mozilla.org/file/local;1"]
                        .createInstance(Components.interfaces.nsILocalFile);
        fileOut.initWithPath("/tmp/calendarEvent.temp");
        var foStream = Components.classes["@mozilla.org/network/file-output-stream;1"]
                                .createInstance(Components. \
                                interfaces.nsIFileOutputStream);
        // above line split on \ for formatting, do not include the line break
        foStream.init(fileOut, 0x02 | 0x08 | 0x20, 0666, 0);
        foStream.write(elementData, elementData.length);
        foStream.close();
        </pre></td></tr></table><br />
            <p>Each
        calendar entry exists in a <code>span</code> element in the HTML. After
        setting up some temporary variables a <code>for</code> loop will process each of those <code>span</code> elements, and the contents will be written out if the text is
        encrypted. <a href="#listing9">Listing 9</a> below calls the <code>CalendarCrypt.pl</code> program with the <code>"decrypt"</code> option to extract the event
        text.</p>
            <br /><a name="listing9"><b>Listing 9. Running encryption script</b></a><br /><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td class="code-outline"><pre class="displaycode">
                

        // create an nsILocalFile for the executable
        var fileExe = Components.classes["@mozilla.org/file/local;1"]
                            .createInstance(Components.interfaces.nsILocalFile);
        fileExe.initWithPath("/tmp/CalendarCrypt.pl");
        var process = Components.classes["@mozilla.org/process/util;1"]
                                .createInstance(Components.interfaces.nsIProcess);
        process.init(fileExe);
        var args = ["decrypt"];
        process.run(true, args, args.length);
</pre></td></tr></table><br />

            <p>Writing
        the encrypted event text to disk and running the decrypt process will create a file with the
        unencrypted event text. Add the code shown below in <a href="#listing10">Listing 10</a> to
        read the data back in and change the presented
        information.</p>
            <br /><a name="listing10"><b>Listing 10. Reading decrypted text</b></a><br /><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td class="code-outline"><pre class="displaycode">
                

        // file input for decrypted event text 
        var data = "";
        var fileIn = Components.classes["@mozilla.org/file/local;1"]
                            .createInstance(Components.interfaces.nsILocalFile);
        fileIn.initWithPath("/tmp/calendarEvent.decrypted");
        var istream = Components.classes["@mozilla.org/network/file-input-stream;1"]
                                .createInstance(Components.interfaces.nsIFileInputStream);
        istream.init(fileIn, 0x01, 0444, 0);
        istream.QueryInterface(Components.interfaces.nsILineInputStream);
        var fstream = Components.classes["@mozilla.org/network/file-input-stream;1"]
                                .createInstance(Components.interfaces.nsIFileInputStream);
        var sstream = Components.classes["@mozilla.org/scriptableinputstream;1"]
                                .createInstance(Components. \
                                interfaces.nsIScriptableInputStream);
        // above line split on \ for formatting, do not include the line break
        fstream.init(fileIn, -1, 0, 0);
        sstream.init(fstream);

        var str = sstream.read(4096);
        while (str.length &gt; 0) {
          data += str;
          str = sstream.read(4096);
        }

        sstream.close();
        fstream.close();

        allSpans[n].innerHTML = data;
</pre></td></tr></table><br />

            <p>This
        reading from a file is similar to the process performed during the encryption step. Note the
        last line in Listing 10 which sets the current <code>span</code> data to the
        unencrypted text instead of the "BEGIN PGP..." original text. Add the code shown below in <a href="#listing11">Listing 11</a> to complete the decryption
        process.</p>
            <br /><a name="listing11"><b>Listing 11. Shred text on disk, loop closure</b></a><br /><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td class="code-outline"><pre class="displaycode">
                

        // sanitize the data stored on disk
        args = ["shred"];
        process.run(true, args, args.length);

      }//if the span item is encrypted

    }//for each span

  }//on page load
}//calendarDecryptExtension
</pre></td></tr></table><br />
            <p>Changing
        the option to <code>"shred"</code> and re-using the <code>nsiProcess</code> component
        ensures the decrypted event text is securely deleted from its temporary location in the
        file system. The next section shows the <code>CalendarCrypt.pl</code> program
        called in the sections above.</p>
            <p><a name="N10238"><span class="smalltitle">CalendarCrypt.pl
        program</span></a></p>

            <p>To complete the encryption support modifications, the <code>CalendarCrypt.pl</code> program is created according to the listings below.
        Note that the implementation shown makes a few assumptions about the most common
        encryption/decryption setups likely for the typical GnuPG user. If desired, consider
        replacing the external program calls and settings with other options enabled by the use of
          <code>GnuPG::Encrypt</code>. For example if you want to use multiple keys,
        or <code>gpg-agent</code> is incompatible with your configuration, the <code>GnuPG::Encrypt</code> Perl module offers many options to help fit your
        environment. Begin by placing the Perl program <code>calendarEncrypt.pl</code>
        in <code>/tmp</code> with the text in <a href="#listing12">Listing 12</a>
        below.</p>
            <br /><a name="listing12"><b>Listing 12. calendarEncrypt.pl header and encryption</b></a><br /><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td class="code-outline"><pre class="displaycode">
                
#!/usr/bin/perl -w 
# calendarEncrypt.pl - encrypt/decrypt/shred files
use strict;

die "specify a mode " unless @ARGV == 1;
my $mode = $ARGV[0];

chomp(my $userName = `whoami`);

if( $mode eq "encrypt" )
{
  my $res = `gpg --yes --armor --encrypt -r $userName /tmp/calendarEvent`;
  $res = `shred /tmp/calendarEvent; rm /tmp/calendarEvent`;
        </pre></td></tr></table><br />

            <p>
      After checking the options and setting up the default username, the <code>/tmp/calendarEvent</code> file is encrypted. Shredding and removing the original plain text
      event file ensures that no sensitive data remains on disk.   
      
      <a href="#listing13">Listing 13</a>
      shown below describes the decrypt mode: </p>
            <br /><a name="listing13"><b>Listing 13. File processing, decryption</b></a><br /><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td class="code-outline"><pre class="displaycode">
                
}elsif( $mode eq "decrypt" )
{

  open(INFILE,"/tmp/calendarEvent.temp") or die "no in file";
  open(OUTFILE,"&gt; /tmp/calendarEvent.encrypted" ) or die "no file out";

    while(my $line =&lt;INFILE&gt;)
    {
      my $begin = substr( $line, 0, 23 );
      print OUTFILE "-----$begin\n";

      my $version = substr( $line, 23, 34 );
      print OUTFILE "$version\n";

      print OUTFILE "\n";

      my $body = substr( $line, 57 );
      $body = substr($body, 0, length($body)-26);

      my @parts = split " ", $body;
      for my $piece( @parts )
      {
        print OUTFILE "$piece\n";
      }

      print OUTFILE "-----END PGP MESSAGE-----\n";
    }#while each line

  close(OUTFILE);
  close(INFILE);

  my $cmd  = qq{ gpg --yes --decrypt /tmp/calendarEvent.encrypted };
     $cmd .= qq{ &gt; /tmp/calendarEvent.decrypted };
  my $res = `$cmd`;
      </pre></td></tr></table><br />

            <p>
      At some point during the upload, processing, or display of a calendar event, some of the
      original formatting is lost. Specifically the "-----" prefix on the "BEGIN PGP"
      message, as
      well as the new line indicators, are stripped out. The string manipulation functions in Listing
      13 replace the lost formatting before the decryption command is called. Finally the code in <a href="#listing14">Listing 14</a> handles the secure deletion of the decrypted text file to
      remove any clear text information stored on disk.</p>
            <br /><a name="listing14"><b>Listing 14. Shred plain text files</b></a><br /><table width="100%" cellpadding="0" cellspacing="0" border="0"><tr><td class="code-outline"><pre class="displaycode">
                

}elsif( $mode eq "shred" )
{
  my $res = `shred /tmp/calendarEvent.decrypted`;
  $res    = `rm /tmp/calendarEvent.decrypted`;
}

# EOF
</pre></td></tr></table><br />
            <p>After
        saving the file as <code>/tmp/CalendarCrypt.pl</code>, make sure the file is
        executable by issuing the command: <code>chmod a+x
        /tmp/CalendarCrypt.pl</code>.</p>
            <br /><table border="0" cellspacing="0" cellpadding="0" width="100%"><tr><td><img width="100%" src="//www.ibm.com/i/v14/rules/blue_rule.gif" height="1" alt=""/></td></tr></table><table class="no-print" cellspacing="0" cellpadding="0" align="right"><tr align="right"><td><table border="0" cellpadding="0" cellspacing="0"><tr><td valign="middle"><img width="16" src="//www.ibm.com/i/v14/icons/u_bold.gif" height="16" border="0" alt=""/><br /></td><td valign="top" align="right"><a href="#main" class="fbox"><b>Back to top</b></a></td></tr></table></td></tr></table><br /><br /><p><a name="N10298"><span class="atitle">Usage examples</span></a></p>

            <p>Each event added using the Google Calendar
        Quick Add procedure will now be intercepted, encrypted, and posted to Google's servers in
        an encrypted form. Reload all chrome events using the Extension Developer's Extension, or
        restart Firefox. Use the Ctrl+; key combination, and add an event such as "Private doctor
        appointment tomorrow 16:30". Open your Google calendar in "regular" mode, and you should see
        an event description like that shown on the left of <a href="#fig1">Figure 1</a>.</p>
            <p>To
        show decrypted events, go to the link: <code>http://www.google.com/calendar/htmlembed?src=&lt;yourCalendarName&gt;%40gmail.com</code>,
        Where &lt;yourCalendarName&gt; is your account username, such as "developer.works" or
        "bob_smith". As the page begins to load, you should see a gpg-agent pop-up requesting your
        passphrase. Enter the passphrase for the user identified by the "uname" command in section 1
        of the <code>CalendarCrypt.pl</code> program, and your events will be
        decrypted and shown on your calendar.</p>
            <br /><table border="0" cellspacing="0" cellpadding="0" width="100%"><tr><td><img width="100%" src="//www.ibm.com/i/v14/rules/blue_rule.gif" height="1" alt=""/></td></tr></table><table class="no-print" cellspacing="0" cellpadding="0" align="right"><tr align="right"><td><table border="0" cellpadding="0" cellspacing="0"><tr><td valign="middle"><img width="16" src="//www.ibm.com/i/v14/icons/u_bold.gif" height="16" border="0" alt=""/><br /></td><td valign="top" align="right"><a href="#main" class="fbox"><b>Back to top</b></a></td></tr></table></td></tr></table><br /><br /><p><a name="N102B1"><span class="atitle">Conclusion, further examples</span></a></p>
            <p>With the tools and code presented
        in this article, you can now store encrypted event text only in Google Calendar. Using the
        modifications to Elias Torres' Google Calendar Quick Add Firefox extension, each event
        added and viewed will be seamlessly encrypted or decrypted. Regain control of some of your
        data, while still reaping the benefits of the best of Web 2.0 applications.</p>
            <p>Consider
        creating an obfuscation layer to change the stored time of events to reduce the
        effectiveness of traffic analysis. Write your own program using the Google Calendar SOAP
        API's to extract, encrypt, and store every calendar event in the past and future. Take on the
        challenge of creating a transparent encryption extension for the default Google Calendar
        interface in all its Ajax-ishness.</p>
        <br /><br /><table border="0" cellspacing="0" cellpadding="0" width="100%"><tr><td><img width="100%" src="//www.ibm.com/i/v14/rules/blue_rule.gif" height="1" alt=""/></td></tr></table><table class="no-print" cellspacing="0" cellpadding="0" align="right"><tr align="right"><td><table border="0" cellpadding="0" cellspacing="0"><tr><td valign="middle"><img width="16" src="//www.ibm.com/i/v14/icons/u_bold.gif" height="16" border="0" alt=""/><br /></td><td valign="top" align="right"><a href="#main" class="fbox"><b>Back to top</b></a></td></tr></table></td></tr></table><br /><br /><p><span class="atitle"><a name="download">Download</a></span></p><table width="100%" class="data-table-1" cellspacing="0" cellpadding="0" border="0"><tr><th scope="col">Description</th><th scope="col">Name</th><th scope="col">Size</th><th scope="col">Download method</th></tr><tr><th class="tb-row" scope="row">Sample code</th><td nowrap="nowrap">calendarEncrypt_0.1.zip</td><td nowrap="nowrap">27KB</td><td nowrap="nowrap"><a class="fbox" href="http://www.ibm.com/developerworks/apps/download/index.jsp?contentid=320748&amp;filename=calendarEncrypt_0.1.zip&amp;method=http&amp;locale=worldwide"><b>HTTP</b></a></td></tr></table><table cellspacing="0" cellpadding="0" border="0"><tr valign="top"><td colspan="5"><img alt="" width="12" height="12" border="0" src="//www.ibm.com/i/c.gif"/></td></tr><tr><td><img alt="" height="16" width="16" src="//www.ibm.com/i/v14/icons/fw.gif"/></td><td><a class="fbox" href="/developerworks/library/whichmethod.html">Information about download methods</a></td><td><img alt="" height="1" width="50" src="//www.ibm.com/i/c.gif"/></td></tr></table><br /><br /><p><a name="resources"><span class="atitle">Resources</span></a></p><b>Learn</b><br /><ul><li>Mozilla has many excellent articles
        about <a href="http://developer.mozilla.org/en/docs/Setting_up_extension_development_environment">Extension Development</a>.<br /><br /></li><li>Get the <a href="http://www.gnupg.org/">Gnu
Privacy Guard</a> to manage encryption.<br /><br /></li><li>The code in this article is based on the <a href="http://torrez.us/code/quickgooglecal/quickgooglecal.xpi">Google Calendar Quick
        Add</a> extension by Elias Torrez.<br /><br /></li><li>For working
        with Firefox, the <a href="http://ted.mielczarek.org/code/mozilla/extensiondev/">Extension
          Developer's Extension</a> is very useful.<br /><br /></li><li>There are many excellent extension-related articles at <a href="http://www.borngeek.com/firefox/">BornGeek.com</a>.<br /><br /></li><li>To listen to interesting interviews and discussions for software
        developers, check out <a href="http://www.ibm.com/developerworks/podcast/" onmouseover="linkQueryAppend(this)">developerWorks podcasts</a>.<br /><br /></li><li>Stay current with developerWorks' <a href="http://www.ibm.com/developerworks/offers/techbriefings/" onmouseover="linkQueryAppend(this)">technical events and webcasts</a>.<br /><br /></li><li>Check out upcoming conferences, trade shows, webcasts, and other
          <a href="http://www.ibm.com/developerworks/views/opensource/events.jsp" onmouseover="linkQueryAppend(this)">events</a> around the world that are of interest to
          IBM open source developers.<br /><br /></li><li> Expand your Web development skills with articles and
        tutorials that specialize in Web technologies in the developerWorks <a href="http://www.ibm.com/developerworks/web">Web development zone</a>. <br /><br /></li></ul><br /><b>Get products and technologies</b><br /><ul><li>Download <a href="http://www.ibm.com/developerworks/downloads/" onmouseover="linkQueryAppend(this)">IBM product evaluation versions</a>, and get your hands on application development tools
        and middleware products from DB2&#174;, Lotus&#174;, Rational&#174;,
          Tivoli&#174;, and WebSphere&#174;.</li></ul><br /><b>Discuss</b><br /><ul><li>Participate in <a href="http://www.ibm.com/developerworks/blogs" onmouseover="linkQueryAppend(this)">developerWorks blogs</a> and get involved in the <a href="http://www.ibm.com/developerworks/community">developerWorks
          community</a>.<br /><br /></li></ul><br /><br /><p><a name="author"><span class="atitle">About the author</span></a></p><table border="0" cellspacing="0" cellpadding="0" width="100%"><tr><td colspan="3"><img alt="" width="100%" height="5" src="//www.ibm.com/i/c.gif"/></td></tr><tr align="left" valign="top"><td><p><img align="left" alt="Nathan Harrington" src="http://www.ibm.com/developerworks/i/p-nharrington.jpg" valign="top"/></p></td><td><img alt="" width="4" height="5" src="//www.ibm.com/i/c.gif"/></td><td width="100%"><p>Nathan Harrington is a programmer working with Linux at IBM.</p></td></tr></table><br /><br /><br /><p class="no-print"><span class="atitle"><a name="rate">Rate this page</a></span></p><span class="no-print"><form action="http://www-128.ibm.com/developerworks/utils/RatingsHandler" method="post"><input value="1" name="SITE_ID" type="hidden"/><input value="Integrate encryption into Google Calendar with Firefox extensions" name="ArticleTitle" type="hidden"/><input value="Web development, Linux, Open source" name="Zone" type="hidden"/><input value="http://www.ibm.com/developerworks/thankyou/feedback-thankyou.html" name="RedirectURL" type="hidden"/><input value="320748" name="ArticleID" type="hidden"/><input value="07152008" name="publish-date" type="hidden"/><input type="hidden" name="author1-email" value="harrington.nathan@gmail.com" /><input type="hidden" name="author1-email-cc" value="" /><script language="javascript" type="text/javascript">document.write('<input type="hidden" name="url" value="'+location.href+'" />');</script><img width="100%" src="//www.ibm.com/i/v14/rules/gray_rule.gif" height="1" alt=""/><br /><table width="100%" class="v14-gray-table-border" cellspacing="0" cellpadding="0" border="0"><tr><td width="100%"><table width="100%" border="0" cellpadding="0" cellspacing="0"><tr><td colspan="3"><p>Please take a moment to complete this form to help us better serve you.</p></td></tr><tr valign="top"><td width="140"><img width="140" src="//www.ibm.com/i/c.gif" height="1" alt=""/><br /><p><label for="Goal">Did the information help you to achieve your goal?</label></p></td><td width="303"><img width="303" src="//www.ibm.com/i/c.gif" height="6" alt=""/><br /><table width="100%" cellspacing="0" cellpadding="0" border="0"><tr><td><input value="Yes" id="goal-yes" name="goal" type="radio"/><label for="goal-yes">Yes</label></td><td><input value="No" id="goal-no" name="goal" type="radio"/><label for="goal-no">No</label></td><td><input value="Don't know" id="goal-undecided" name="goal" type="radio"/><label for="goal-undecided">Don't know</label></td></tr></table></td><td width="100%"> </td></tr><tr><td colspan="3"><img alt="" height="12" width="8" src="//www.ibm.com/i/c.gif"/></td></tr><tr valign="top"><td width="140"><img width="140" src="//www.ibm.com/i/c.gif" height="1" alt=""/><br /><p><label for="Comments">Please provide us with comments to help improve this page:</label></p></td><td width="303"><img width="303" src="//www.ibm.com/i/c.gif" height="6" alt=""/><br /><table width="100%" cellspacing="0" cellpadding="0" border="0"><tr><td><textarea class="iform" cols="35" rows="5" wrap="virtual" id="Comments" name="Comments"> </textarea></td></tr></table></td><td width="100%"> </td></tr><tr><td colspan="3"><img alt="" height="12" width="8" src="//www.ibm.com/i/c.gif"/></td></tr><tr valign="top"><td width="140"><img width="140" src="//www.ibm.com/i/c.gif" height="1" alt=""/><br /><p><label for="Rating">How useful is the information?</label></p></td><td width="303"><img width="303" src="//www.ibm.com/i/c.gif" height="6" alt=""/><br /><table width="100%" cellspacing="0" cellpadding="0" border="0"><tr><td align="left" width="58"><input value="1" id="Rating1" name="Rating" type="radio"/><label for="Rating1">1</label></td><td align="left" width="58"><input value="2" id="Rating2" name="Rating" type="radio"/><label for="Rating2">2</label></td><td align="left" width="58"><input value="3" id="Rating3" name="Rating" type="radio"/><label for="Rating3">3</label></td><td align="left" width="58"><input value="4" id="Rating4" name="Rating" type="radio"/><label for="Rating4">4</label></td><td align="left" width="61"><input value="5" id="Rating5" name="Rating" type="radio"/><label for="Rating5">5</label></td></tr><tr><td align="left" width="60"><span class="greytext">Not</span><br /><span class="greytext">useful</span></td><td align="left" width="60"><img src="//www.ibm.com/i/c.gif" height="1" width="1" alt=""/></td><td align="left" width="60"><img src="//www.ibm.com/i/c.gif" height="1" width="1" alt=""/></td><td align="left" width="60"><img src="//www.ibm.com/i/c.gif" height="1" width="1" alt=""/></td><td align="left" width="63"><span class="greytext">Extremely<br />useful</span></td></tr></table></td><td width="100%"> </td></tr></table></td></tr></table><table class="v14-gray-table-border" width="100%" border="0" cellpadding="0" cellspacing="0"><tr><td colspan="3"><img alt="" height="8" width="8" src="//www.ibm.com/i/c.gif"/></td></tr><tr><td width="8"><img alt="" height="1" width="8" src="//www.ibm.com/i/c.gif"/></td><td colspan="3"><input alt="Submit" height="21" width="120" border="0" src="//www.ibm.com/i/v14/buttons/submit.gif" type="image"/></td></tr><tr><td colspan="3"><img alt="" height="8" width="8" src="//www.ibm.com/i/c.gif"/></td></tr></table></form><br /></span><br /><p><table width="100%" cellpadding="5" cellspacing="0" border="0">
<tr><td><span class="atitle">Share this.... </span><p>
<table cellpadding="0" cellspacing="0" width="100%" border="0">
<tr align="left" valign="top">
<td width="21">
	<a href="javascript:location.href='http://digg.com/submit?phase=2&amp;url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title)">
<img src="http://www.ibm.com/i/v14/icons/10x10-digg-thumb.gif" width="10" height="10" alt="digg" border="0"/></a></td>
	<td width="120">
             <a href="javascript:location.href='http://digg.com/submit?phase=2&amp;url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title)"><span style="nowrap">Digg this story</span></a></td>

<!--<td width="8"><img alt="" height="1" width="8" src="//www.ibm.com/i/c.gif"/></td>-->
<td width="21"><img src="/developerworks/i/icon_delicious.gif" height="16" width="16" alt="del.icio.us" border="0"/> </td>
<td width="100"><a class="fbox" href="http://del.icio.us/post" onclick="window.open('http://del.icio.us/post?v=4&amp;noui&amp;jump=close&amp;url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title), 'delicious','toolbar=no,width=700,height=400'); return false;"><span style="nowrap">del.icio.us</span></a></td>

<!--<td width="8"><img alt="" height="1" width="8" src="//www.ibm.com/i/c.gif"/></td>-->
<td width="21">
	<!-- start Slashdot it link -->
	<a href="javascript:location.href='http://slashdot.org/bookmark.pl?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title)">
									<img src="/developerworks/i/slashdot-favicon.gif" alt="Slashdot" border="0" height="16" width="16"/></a></td>
	<td width="120"><a href="javascript:location.href='http://slashdot.org/bookmark.pl?url='+encodeURIComponent(location.href)+'&amp;title='+encodeURIComponent(document.title)">Slashdot it!</a></td>
<!--<td width="8"><img alt="" height="1" width="8" src="//www.ibm.com/i/c.gif"/></td>-->
<td><img alt="" height="5" width="8" src="//www.ibm.com/i/c.gif"/></td>
</tr>

</table></p>
</td></tr></table>
</p><!--START RESERVED FOR FUTURE USE INCLUDE FILES--><!-- NO RESERVED CONTENT --><!--END RESERVED FOR FUTURE USE INCLUDE FILES--><br /></td><td width="10"><img alt="" height="1" width="10" src="//www.ibm.com/i/c.gif"/></td></tr></table></td></tr></table><!--FOOTER_BEGIN--><div id="ibm-page-tools">
<!-- IBM page tools -->
</div>
<div id="ibm-footer">
<ul>
<li class="ibm-first"><a href="http://www.ibm.com/ibm/us/en/">About IBM</a></li>
<li><a href="http://www.ibm.com/privacy/us/en/">Privacy</a></li>
<li><a href="http://www.ibm.com/contact/us/en/">Contact</a></li>
<li><a href="http://www.ibm.com/legal/us/en/">Terms of use</a></li>
</ul>
</div>

</div>

<script type="text/javascript" language="JavaScript1.2" src="//www.ibm.com/common/stats/stats.js"></script>
<noscript><img src="//stats.www.ibm.com/rc/images/uc.GIF?R=noscript" width="1" height="1" alt="" border="0" /></noscript><!--FOOTER_END--><!--XSLT stylesheet used to transform this file:  dw-document-html-5.10.xsl--></body></html>